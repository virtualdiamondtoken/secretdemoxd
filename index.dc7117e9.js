var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},r={},i=e.parcelRequireb88b;null==i&&((i=function(e){if(e in t)return t[e].exports;if(e in r){var i=r[e];delete r[e];var o={id:e,exports:{}};return t[e]=o,i.call(o.exports,o,o.exports),o.exports}var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){r[e]=t},e.parcelRequireb88b=i);var o=i("bexK8"),n=i("9ZOeg"),s=i("kXB5i");o=i("bexK8"),o=i("bexK8");class a{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const l=new o.OrthographicCamera(-1,1,1,-1,0,1),h=new o.BufferGeometry;h.setAttribute("position",new o.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),h.setAttribute("uv",new o.Float32BufferAttribute([0,2,0,0,2,0],2));class c{constructor(e){this._mesh=new o.Mesh(h,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,l)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}o=i("bexK8");var u={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"};const d={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new((o=i("bexK8")).Color)(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class m extends a{constructor(e,t,r,i){super(),this.strength=void 0!==t?t:1,this.radius=r,this.threshold=i,this.resolution=void 0!==e?new o.Vector2(e.x,e.y):new o.Vector2(256,256),this.clearColor=new o.Color(0,0,0);const n={minFilter:o.LinearFilter,magFilter:o.LinearFilter,format:o.RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new o.WebGLRenderTarget(s,a,n),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let e=0;e<this.nMips;e++){const t=new o.WebGLRenderTarget(s,a,n);t.texture.name="UnrealBloomPass.h"+e,t.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(t);const r=new o.WebGLRenderTarget(s,a,n);r.texture.name="UnrealBloomPass.v"+e,r.texture.generateMipmaps=!1,this.renderTargetsVertical.push(r),s=Math.round(s/2),a=Math.round(a/2)}void 0===d&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const l=d;this.highPassUniforms=o.UniformsUtils.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=i,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new o.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const h=[3,5,7,9,11];s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);for(let e=0;e<this.nMips;e++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(h[e])),this.separableBlurMaterials[e].uniforms.texSize.value=new o.Vector2(s,a),s=Math.round(s/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new o.Vector3(1,1,1),new o.Vector3(1,1,1),new o.Vector3(1,1,1),new o.Vector3(1,1,1),new o.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===u&&console.error("THREE.UnrealBloomPass relies on CopyShader");const m=u;this.copyUniforms=o.UniformsUtils.clone(m.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new o.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,blending:o.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new o.Color,this.oldClearAlpha=1,this.basic=new o.MeshBasicMaterial,this.fsQuad=new c(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,t){let r=Math.round(e/2),i=Math.round(t/2);this.renderTargetBright.setSize(r,i);for(let e=0;e<this.nMips;e++)this.renderTargetsHorizontal[e].setSize(r,i),this.renderTargetsVertical[e].setSize(r,i),this.separableBlurMaterials[e].uniforms.texSize.value=new o.Vector2(r,i),r=Math.round(r/2),i=Math.round(i/2)}render(e,t,r,i,o){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const n=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),o&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let s=this.renderTargetBright;for(let t=0;t<this.nMips;t++)this.fsQuad.material=this.separableBlurMaterials[t],this.separableBlurMaterials[t].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[t].uniforms.direction.value=m.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[t]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[t].uniforms.colorTexture.value=this.renderTargetsHorizontal[t].texture,this.separableBlurMaterials[t].uniforms.direction.value=m.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[t]),e.clear(),this.fsQuad.render(e),s=this.renderTargetsVertical[t];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,o&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=n}getSeperableBlurMaterial(e){return new o.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new o.Vector2(.5,.5)},direction:{value:new o.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new o.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform sampler2D dirtTexture;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}m.BlurDirectionX=new o.Vector2(1,0),m.BlurDirectionY=new o.Vector2(0,1);o=i("bexK8"),o=i("bexK8");class f extends a{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof o.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=o.UniformsUtils.clone(e.uniforms),this.material=new o.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new c(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class p extends a{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){const i=e.getContext(),o=e.state;let n,s;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(n=0,s=1):(n=1,s=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),o.buffers.stencil.setFunc(i.ALWAYS,n,4294967295),o.buffers.stencil.setClear(s),o.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(i.EQUAL,1,4294967295),o.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),o.buffers.stencil.setLocked(!0)}}class g extends a{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}new o.OrthographicCamera(-1,1,1,-1,0,1);const b=new o.BufferGeometry;b.setAttribute("position",new o.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),b.setAttribute("uv",new o.Float32BufferAttribute([0,2,0,0,2,0],2));o=i("bexK8");const v={type:"change"},T={type:"start"},x={type:"end"};class w extends o.EventDispatcher{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new o.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:o.MOUSE.ROTATE,MIDDLE:o.MOUSE.DOLLY,RIGHT:o.MOUSE.PAN},this.touches={ONE:o.TOUCH.ROTATE,TWO:o.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",W),this._domElementKeyEvents=e},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(v),r.update(),n=i.NONE},this.update=function(){const t=new o.Vector3,d=(new o.Quaternion).setFromUnitVectors(e.up,new o.Vector3(0,1,0)),m=d.clone().invert(),f=new o.Vector3,p=new o.Quaternion,g=2*Math.PI;return function(){const e=r.object.position;t.copy(e).sub(r.target),t.applyQuaternion(d),a.setFromVector3(t),r.autoRotate&&n===i.NONE&&P(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(a.theta+=l.theta*r.dampingFactor,a.phi+=l.phi*r.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let o=r.minAzimuthAngle,b=r.maxAzimuthAngle;return isFinite(o)&&isFinite(b)&&(o<-Math.PI?o+=g:o>Math.PI&&(o-=g),b<-Math.PI?b+=g:b>Math.PI&&(b-=g),a.theta=o<=b?Math.max(o,Math.min(b,a.theta)):a.theta>(o+b)/2?Math.max(o,a.theta):Math.min(b,a.theta)),a.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=h,a.radius=Math.max(r.minDistance,Math.min(r.maxDistance,a.radius)),!0===r.enableDamping?r.target.addScaledVector(c,r.dampingFactor):r.target.add(c),t.setFromSpherical(a),t.applyQuaternion(m),e.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(l.theta*=1-r.dampingFactor,l.phi*=1-r.dampingFactor,c.multiplyScalar(1-r.dampingFactor)):(l.set(0,0,0),c.set(0,0,0)),h=1,!!(u||f.distanceToSquared(r.object.position)>s||8*(1-p.dot(r.object.quaternion))>s)&&(r.dispatchEvent(v),f.copy(r.object.position),p.copy(r.object.quaternion),u=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",X),r.domElement.removeEventListener("pointerdown",k),r.domElement.removeEventListener("pointercancel",K),r.domElement.removeEventListener("wheel",Q),r.domElement.removeEventListener("pointermove",I),r.domElement.removeEventListener("pointerup",Y),null!==r._domElementKeyEvents&&r._domElementKeyEvents.removeEventListener("keydown",W)};const r=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let n=i.NONE;const s=1e-6,a=new o.Spherical,l=new o.Spherical;let h=1;const c=new o.Vector3;let u=!1;const d=new o.Vector2,m=new o.Vector2,f=new o.Vector2,p=new o.Vector2,g=new o.Vector2,b=new o.Vector2,w=new o.Vector2,M=new o.Vector2,y=new o.Vector2,S=[],E={};function C(){return Math.pow(.95,r.zoomSpeed)}function P(e){l.theta-=e}function A(e){l.phi-=e}const O=function(){const e=new o.Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),c.add(e)}}(),R=function(){const e=new o.Vector3;return function(t,i){!0===r.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),c.add(e)}}(),L=function(){const e=new o.Vector3;return function(t,i){const o=r.domElement;if(r.object.isPerspectiveCamera){const n=r.object.position;e.copy(n).sub(r.target);let s=e.length();s*=Math.tan(r.object.fov/2*Math.PI/180),O(2*t*s/o.clientHeight,r.object.matrix),R(2*i*s/o.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(O(t*(r.object.right-r.object.left)/r.object.zoom/o.clientWidth,r.object.matrix),R(i*(r.object.top-r.object.bottom)/r.object.zoom/o.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function _(e){r.object.isPerspectiveCamera?h/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function U(e){r.object.isPerspectiveCamera?h*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function B(e){d.set(e.clientX,e.clientY)}function D(e){p.set(e.clientX,e.clientY)}function z(){if(1===S.length)d.set(S[0].pageX,S[0].pageY);else{const e=.5*(S[0].pageX+S[1].pageX),t=.5*(S[0].pageY+S[1].pageY);d.set(e,t)}}function F(){if(1===S.length)p.set(S[0].pageX,S[0].pageY);else{const e=.5*(S[0].pageX+S[1].pageX),t=.5*(S[0].pageY+S[1].pageY);p.set(e,t)}}function V(){const e=S[0].pageX-S[1].pageX,t=S[0].pageY-S[1].pageY,r=Math.sqrt(e*e+t*t);w.set(0,r)}function N(e){if(1==S.length)m.set(e.pageX,e.pageY);else{const t=q(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);m.set(r,i)}f.subVectors(m,d).multiplyScalar(r.rotateSpeed);const t=r.domElement;P(2*Math.PI*f.x/t.clientHeight),A(2*Math.PI*f.y/t.clientHeight),d.copy(m)}function H(e){if(1===S.length)g.set(e.pageX,e.pageY);else{const t=q(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);g.set(r,i)}b.subVectors(g,p).multiplyScalar(r.panSpeed),L(b.x,b.y),p.copy(g)}function j(e){const t=q(e),i=e.pageX-t.x,o=e.pageY-t.y,n=Math.sqrt(i*i+o*o);M.set(0,n),y.set(0,Math.pow(M.y/w.y,r.zoomSpeed)),_(y.y),w.copy(M)}function k(e){!1!==r.enabled&&(0===S.length&&(r.domElement.setPointerCapture(e.pointerId),r.domElement.addEventListener("pointermove",I),r.domElement.addEventListener("pointerup",Y)),function(e){S.push(e)}(e),"touch"===e.pointerType?function(e){switch(Z(e),S.length){case 1:switch(r.touches.ONE){case o.TOUCH.ROTATE:if(!1===r.enableRotate)return;z(),n=i.TOUCH_ROTATE;break;case o.TOUCH.PAN:if(!1===r.enablePan)return;F(),n=i.TOUCH_PAN;break;default:n=i.NONE}break;case 2:switch(r.touches.TWO){case o.TOUCH.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&V(),r.enablePan&&F(),n=i.TOUCH_DOLLY_PAN;break;case o.TOUCH.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&V(),r.enableRotate&&z(),n=i.TOUCH_DOLLY_ROTATE;break;default:n=i.NONE}break;default:n=i.NONE}n!==i.NONE&&r.dispatchEvent(T)}(e):function(e){let t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case o.MOUSE.DOLLY:if(!1===r.enableZoom)return;!function(e){w.set(e.clientX,e.clientY)}(e),n=i.DOLLY;break;case o.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;D(e),n=i.PAN}else{if(!1===r.enableRotate)return;B(e),n=i.ROTATE}break;case o.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;B(e),n=i.ROTATE}else{if(!1===r.enablePan)return;D(e),n=i.PAN}break;default:n=i.NONE}n!==i.NONE&&r.dispatchEvent(T)}(e))}function I(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(Z(e),n){case i.TOUCH_ROTATE:if(!1===r.enableRotate)return;N(e),r.update();break;case i.TOUCH_PAN:if(!1===r.enablePan)return;H(e),r.update();break;case i.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(e){r.enableZoom&&j(e),r.enablePan&&H(e)}(e),r.update();break;case i.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(e){r.enableZoom&&j(e),r.enableRotate&&N(e)}(e),r.update();break;default:n=i.NONE}}(e):function(e){if(!1===r.enabled)return;switch(n){case i.ROTATE:if(!1===r.enableRotate)return;!function(e){m.set(e.clientX,e.clientY),f.subVectors(m,d).multiplyScalar(r.rotateSpeed);const t=r.domElement;P(2*Math.PI*f.x/t.clientHeight),A(2*Math.PI*f.y/t.clientHeight),d.copy(m),r.update()}(e);break;case i.DOLLY:if(!1===r.enableZoom)return;!function(e){M.set(e.clientX,e.clientY),y.subVectors(M,w),y.y>0?_(C()):y.y<0&&U(C()),w.copy(M),r.update()}(e);break;case i.PAN:if(!1===r.enablePan)return;!function(e){g.set(e.clientX,e.clientY),b.subVectors(g,p).multiplyScalar(r.panSpeed),L(b.x,b.y),p.copy(g),r.update()}(e)}}(e))}function Y(e){!1!==r.enabled&&(e.pointerType,r.dispatchEvent(x),n=i.NONE,G(e),0===S.length&&(r.domElement.releasePointerCapture(e.pointerId),r.domElement.removeEventListener("pointermove",I),r.domElement.removeEventListener("pointerup",Y)))}function K(e){G(e)}function Q(e){!1===r.enabled||!1===r.enableZoom||n!==i.NONE&&n!==i.ROTATE||(e.preventDefault(),r.dispatchEvent(T),function(e){e.deltaY<0?U(C()):e.deltaY>0&&_(C()),r.update()}(e),r.dispatchEvent(x))}function W(e){!1!==r.enabled&&!1!==r.enablePan&&function(e){let t=!1;switch(e.code){case r.keys.UP:L(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:L(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:L(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:L(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}(e)}function X(e){!1!==r.enabled&&e.preventDefault()}function G(e){delete E[e.pointerId];for(let t=0;t<S.length;t++)if(S[t].pointerId==e.pointerId)return void S.splice(t,1)}function Z(e){let t=E[e.pointerId];void 0===t&&(t=new o.Vector2,E[e.pointerId]=t),t.set(e.pageX,e.pageY)}function q(e){const t=e.pointerId===S[0].pointerId?S[1]:S[0];return E[t.pointerId]}r.domElement.addEventListener("contextmenu",X),r.domElement.addEventListener("pointerdown",k),r.domElement.addEventListener("pointercancel",K),r.domElement.addEventListener("wheel",Q,{passive:!1}),this.update()}}const M=document.querySelector(".content"),y=new o.Scene,S=new o.PerspectiveCamera(60,M.offsetWidth/M.offsetHeight,.001,50);S.position.z=8;const E=new o.WebGLRenderer;E.setPixelRatio(2),E.setSize(M.offsetWidth,M.offsetHeight),M.appendChild(E.domElement);const C=new class extends a{constructor(e,t,r,i,n){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=i,this.clearAlpha=void 0!==n?n:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new o.Color}render(e,t,r){const i=e.autoClear;let o,n;e.autoClear=!1,void 0!==this.overrideMaterial&&(n=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),o=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,o),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=n),e.autoClear=i}}(y,S),P=new w(S,E.domElement);P.enableDamping=!0,P.dampingFactor=.05;const A=new m(new o.Vector2(M.offsetWidth,M.offsetHeight),1.5,.4,.85);A.threshold=0,A.strength=.6;const O=new class{constructor(e,t){if(this.renderer=e,void 0===t){const r={minFilter:o.LinearFilter,magFilter:o.LinearFilter,format:o.RGBAFormat},i=e.getSize(new o.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,(t=new o.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===u&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===f&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new f(u),this.clock=new o.Clock}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let r=!1;for(let t=0,i=this.passes.length;t<i;t++){const i=this.passes[t];if(!1!==i.enabled){if(i.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),i.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),i.needsSwap){if(r){const t=this.renderer.getContext(),r=this.renderer.state.buffers.stencil;r.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),r.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==p&&(i instanceof p?r=!0:i instanceof g&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new o.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}(E);O.setPixelRatio(2),O.addPass(C),O.addPass(A);const R=new o.Group;y.add(R);const L=[],_=new o.BufferGeometry,U=new o.ShaderMaterial({uniforms:{pointTexture:{value:(new o.TextureLoader).load("dotTexture.png")}},vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent,blending:o.AdditiveBlending,alphaTest:1,transparent:!0}),B=new o.Points(_,U);R.add(B);let D=null;const z=[];let F=[new o.LineBasicMaterial({transparent:!0,color:1203608}),new o.LineBasicMaterial({transparent:!0,color:13620958})],V=[new o.Color("#f9fbf2").multiplyScalar(.8),new o.Color("#ffede1").multiplyScalar(.8),new o.Color("#05c7f2").multiplyScalar(.8),new o.Color("#0597f2").multiplyScalar(.8),new o.Color("#0476d9").multiplyScalar(.8)];let N=null;(new n.OBJLoader).load("lynx_bobcat_01.obj",(e=>{N=e.children[0];let t=window.screen.height,r=window.screen.width;t<850&&r<400?(N.geometry.scale(.05,.05,.05),N.geometry.translate(0,-1.5,0)):(N.geometry.scale(.065,.065,.065),N.geometry.translate(0,-3,0)),N.geometry.rotateY(.2),function(){D=new s.MeshSurfaceSampler(N).build();for(let e=0;e<6;e++){const t=new o.Line(new o.BufferGeometry,F[e%2]);t.coordinates=[],t.previous=null,z.push(t),R.add(t)}requestAnimationFrame(q)}()}),(e=>console.log(e.loaded/e.total*100+"% loaded")),(e=>console.log("An error happened",e)));const H=new o.Vector3;function j(e){let t=!1;for(;!t;)if(D.sample(H),e.previous&&H.distanceTo(e.previous)<.3){e.coordinates.push(H.x,H.y,H.z),e.previous=H.clone();for(let t=0;t<2;t++){const t=new k;t.setup(H,e.material.color),L.push(t)}t=!0}else e.previous||(e.previous=H.clone())}class k extends o.Vector3{setup(e,t){this.x=e.x,this.y=e.y,this.z=e.z,this.v=new o.Vector3,this.v.x=o.MathUtils.randFloat(.001,.006),this.v.x*=Math.random()>.5?1:-1,this.v.y=o.MathUtils.randFloat(.001,.006),this.v.y*=Math.random()>.5?1:-1,this.v.z=o.MathUtils.randFloat(.001,.006),this.v.z*=Math.random()>.5?1:-1,this.size=4*Math.random()+1,this.slowDown=.4+.58*Math.random(),this.color=t}update(){(this.v.x>.001||this.v.y>.001||this.v.z>.001)&&(this.add(this.v),this.v.multiplyScalar(this.slowDown))}}class I{setup(e){this.r=12*Math.random()+3,this.phi=Math.random()*Math.PI*2,this.theta=Math.random()*Math.PI,this.v=(new o.Vector2).random().subScalar(.5).multiplyScalar(7e-4),this.x=this.r*Math.sin(this.phi)*Math.sin(this.theta),this.y=this.r*Math.cos(this.phi),this.z=this.r*Math.sin(this.phi)*Math.cos(this.theta),this.size=4*Math.random()+1,this.color=e}update(){this.phi+=this.v.x,this.theta+=this.v.y,this.x=this.r*Math.sin(this.phi)*Math.sin(this.theta),this.y=this.r*Math.cos(this.phi),this.z=this.r*Math.sin(this.phi)*Math.cos(this.theta)}}const Y=[],K=[],Q=[],W=[];for(let e=0;e<1500;e++){const e=new I;e.setup(V[Math.floor(Math.random()*V.length)]),K.push(e.x,e.y,e.z),Q.push(e.color.r,e.color.g,e.color.b),W.push(e.size),Y.push(e)}const X=new o.BufferGeometry;X.setAttribute("size",new o.Float32BufferAttribute(W,1)),X.setAttribute("color",new o.Float32BufferAttribute(Q,3));const G=new o.Points(X,U);y.add(G);let Z=0;function q(e){requestAnimationFrame(q),G.rotation.y+=5e-4,R.rotation.x=.1*Math.sin(3e-4*e),R.rotation.y+=.001,e-Z>30&&(z.forEach((e=>{L.length<35e3&&(j(e),j(e));const t=new Float32Array(e.coordinates);e.geometry.setAttribute("position",new o.BufferAttribute(t,3)),e.geometry.computeBoundingSphere()})),function(){let e=[],t=[];L.forEach((r=>{e.push(r.size),t.push(r.color.r,r.color.g,r.color.b)})),_.setAttribute("color",new o.Float32BufferAttribute(t,3)),_.setAttribute("size",new o.Float32BufferAttribute(e,1))}(),Z=e);let t=[];L.forEach((e=>{e.update(),t.push(e.x,e.y,e.z)})),_.setAttribute("position",new o.Float32BufferAttribute(t,3));let r=[];Y.forEach((e=>{e.update(),r.push(e.x,e.y,e.z)})),X.setAttribute("position",new o.Float32BufferAttribute(r,3)),O.render(),P.update()}window.addEventListener("resize",(function(){S.aspect=M.offsetWidth/M.offsetHeight,S.updateProjectionMatrix(),O.setSize(M.offsetWidth,M.offsetHeight),E.setSize(M.offsetWidth,M.offsetHeight),A.setSize(M.offsetWidth,M.offsetHeight)}));